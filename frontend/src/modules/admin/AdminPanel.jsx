import React, { useState } from 'react';\nimport { Container, Row, Col, Card, Button, Modal, Form, Table, Tab, Tabs, Badge } from 'react-bootstrap';\nimport { categories, users, contactQueries } from '../../data/demoData';\nimport { toast } from 'react-toastify';\n\nconst AdminPanel = () => {\n  const [showAddCategory, setShowAddCategory] = useState(false);\n  const [showAddUser, setShowAddUser] = useState(false);\n  const [newCategory, setNewCategory] = useState('');\n  const [newUser, setNewUser] = useState({ name: '', email: '', role: 'shopkeeper' });\n  const [localCategories, setLocalCategories] = useState(categories);\n  const [localUsers, setLocalUsers] = useState(users);\n\n  const handleAddCategory = () => {\n    if (newCategory.trim()) {\n      const newCat = {\n        id: Date.now(),\n        name: newCategory,\n        subcategories: []\n      };\n      setLocalCategories(prev => [...prev, newCat]);\n      setNewCategory('');\n      setShowAddCategory(false);\n      toast.success('âœ… Category added successfully!');\n    } else {\n      toast.error('âŒ Please enter category name');\n    }\n  };\n\n  const handleAddUser = () => {\n    if (newUser.name && newUser.email) {\n      const user = {\n        id: Date.now(),\n        ...newUser\n      };\n      setLocalUsers(prev => [...prev, user]);\n      setNewUser({ name: '', email: '', role: 'shopkeeper' });\n      setShowAddUser(false);\n      toast.success('âœ… User added successfully!');\n    } else {\n      toast.error('âŒ Please fill all fields');\n    }\n  };\n\n  const toggleUserStatus = (userId) => {\n    toast.success('âœ… User status updated!');\n  };\n\n  const deleteCategory = (categoryId) => {\n    setLocalCategories(prev => prev.filter(cat => cat.id !== categoryId));\n    toast.success('ğŸ—‘ï¸ Category deleted!');\n  };\n\n  const stats = {\n    totalUsers: localUsers.length,\n    totalCategories: localCategories.length,\n    totalSubcategories: localCategories.reduce((sum, cat) => sum + cat.subcategories.length, 0),\n    pendingQueries: contactQueries.length\n  };\n\n  return (\n    <div style={{ minHeight: '100vh', backgroundColor: '#f8f9fa' }}>\n      <Container fluid className=\"py-4\">\n        <Row className=\"mb-4\">\n          <Col>\n            <h2>âš™ï¸ Admin Control Panel</h2>\n          </Col>\n        </Row>\n        \n        {/* Stats Cards */}\n        <Row className=\"mb-4\">\n          <Col md={3}>\n            <Card className=\"text-center shadow-sm border-primary\">\n              <Card.Body>\n                <div style={{ fontSize: '2rem' }}>ğŸ‘¥</div>\n                <h3 className=\"text-primary\">{stats.totalUsers}</h3>\n                <p className=\"mb-0\">Total Users</p>\n              </Card.Body>\n            </Card>\n          </Col>\n          <Col md={3}>\n            <Card className=\"text-center shadow-sm border-success\">\n              <Card.Body>\n                <div style={{ fontSize: '2rem' }}>ğŸ“</div>\n                <h3 className=\"text-success\">{stats.totalCategories}</h3>\n                <p className=\"mb-0\">Categories</p>\n              </Card.Body>\n            </Card>\n          </Col>\n          <Col md={3}>\n            <Card className=\"text-center shadow-sm border-warning\">\n              <Card.Body>\n                <div style={{ fontSize: '2rem' }}>ğŸ“‚</div>\n                <h3 className=\"text-warning\">{stats.totalSubcategories}</h3>\n                <p className=\"mb-0\">Subcategories</p>\n              </Card.Body>\n            </Card>\n          </Col>\n          <Col md={3}>\n            <Card className=\"text-center shadow-sm border-info\">\n              <Card.Body>\n                <div style={{ fontSize: '2rem' }}>ğŸ’¬</div>\n                <h3 className=\"text-info\">{stats.pendingQueries}</h3>\n                <p className=\"mb-0\">Pending Queries</p>\n              </Card.Body>\n            </Card>\n          </Col>\n        </Row>\n        \n        <Card className=\"shadow-sm\">\n          <Card.Body>\n            <Tabs defaultActiveKey=\"users\" className=\"mb-3\">\n              <Tab eventKey=\"users\" title=\"ğŸ‘¥ User Management\">\n                <div className=\"d-flex justify-content-between align-items-center mb-3\">\n                  <h5 className=\"mb-0\">Manage Users</h5>\n                  <Button \n                    variant=\"primary\" \n                    size=\"sm\"\n                    onClick={() => setShowAddUser(true)}\n                  >\n                    â• Add User\n                  </Button>\n                </div>\n                \n                <div className=\"table-responsive\">\n                  <Table striped hover>\n                    <thead className=\"table-light\">\n                      <tr>\n                        <th>User</th>\n                        <th>Email</th>\n                        <th>Role</th>\n                        <th>Status</th>\n                        <th>Actions</th>\n                      </tr>\n                    </thead>\n                    <tbody>\n                      {localUsers.map(user => (\n                        <tr key={user.id}>\n                          <td>\n                            <div className=\"d-flex align-items-center\">\n                              <div className=\"me-2\" style={{ fontSize: '1.5rem' }}>\n                                {user.role === 'admin' ? 'ğŸ‘‘' : \n                                 user.role === 'vendor' ? 'ğŸª' : 'ğŸ›’'}\n                              </div>\n                              <strong>{user.name}</strong>\n                            </div>\n                          </td>\n                          <td>{user.email}</td>\n                          <td>\n                            <Badge bg={\n                              user.role === 'admin' ? 'danger' : \n                              user.role === 'vendor' ? 'warning' : 'info'\n                            }>\n                              {user.role.toUpperCase()}\n                            </Badge>\n                          </td>\n                          <td>\n                            <Badge bg=\"success\">âœ… Active</Badge>\n                          </td>\n                          <td>\n                            <div className=\"d-flex gap-1\">\n                              <Button \n                                variant=\"outline-primary\" \n                                size=\"sm\"\n                                onClick={() => toast.info('âœï¸ Edit feature coming soon!')}\n                              >\n                                âœï¸\n                              </Button>\n                              <Button \n                                variant=\"outline-warning\" \n                                size=\"sm\"\n                                onClick={() => toggleUserStatus(user.id)}\n                              >\n                                â¸ï¸\n                              </Button>\n                            </div>\n                          </td>\n                        </tr>\n                      ))}\n                    </tbody>\n                  </Table>\n                </div>\n              </Tab>\n              \n              <Tab eventKey=\"categories\" title=\"ğŸ“ Categories\">\n                <div className=\"d-flex justify-content-between align-items-center mb-3\">\n                  <h5 className=\"mb-0\">Manage Categories</h5>\n                  <Button \n                    variant=\"primary\" \n                    size=\"sm\"\n                    onClick={() => setShowAddCategory(true)}\n                  >\n                    â• Add Category\n                  </Button>\n                </div>\n                \n                <div className=\"table-responsive\">\n                  <Table striped hover>\n                    <thead className=\"table-light\">\n                      <tr>\n                        <th>Category</th>\n                        <th>Subcategories</th>\n                        <th>Count</th>\n                        <th>Actions</th>\n                      </tr>\n                    </thead>\n                    <tbody>\n                      {localCategories.map(category => (\n                        <tr key={category.id}>\n                          <td>\n                            <div className=\"d-flex align-items-center\">\n                              <div className=\"me-2\" style={{ fontSize: '1.5rem' }}>\n                                {category.name === 'Electronics' ? 'ğŸ“±' : 'ğŸ‘•'}\n                              </div>\n                              <strong>{category.name}</strong>\n                            </div>\n                          </td>\n                          <td>\n                            {category.subcategories.length > 0 ? (\n                              category.subcategories.map(sub => (\n                                <Badge key={sub.id} bg=\"secondary\" className=\"me-1\">\n                                  {sub.name}\n                                </Badge>\n                              ))\n                            ) : (\n                              <span className=\"text-muted\">No subcategories</span>\n                            )}\n                          </td>\n                          <td>\n                            <Badge bg=\"info\">{category.subcategories.length}</Badge>\n                          </td>\n                          <td>\n                            <div className=\"d-flex gap-1\">\n                              <Button \n                                variant=\"outline-primary\" \n                                size=\"sm\"\n                                onClick={() => toast.info('âœï¸ Edit feature coming soon!')}\n                              >\n                                âœï¸\n                              </Button>\n                              <Button \n                                variant=\"outline-danger\" \n                                size=\"sm\"\n                                onClick={() => deleteCategory(category.id)}\n                              >\n                                ğŸ—‘ï¸\n                              </Button>\n                            </div>\n                          </td>\n                        </tr>\n                      ))}\n                    </tbody>\n                  </Table>\n                </div>\n              </Tab>\n              \n              <Tab eventKey=\"queries\" title=\"ğŸ’¬ Support Queries\">\n                <h5 className=\"mb-3\">Customer Support Queries</h5>\n                <div className=\"table-responsive\">\n                  <Table striped hover>\n                    <thead className=\"table-light\">\n                      <tr>\n                        <th>Customer</th>\n                        <th>Email</th>\n                        <th>Message</th>\n                        <th>Status</th>\n                        <th>Actions</th>\n                      </tr>\n                    </thead>\n                    <tbody>\n                      {contactQueries.map(query => (\n                        <tr key={query.id}>\n                          <td>ğŸ‘¤ {query.name}</td>\n                          <td>{query.email}</td>\n                          <td>\n                            <div style={{ maxWidth: '200px' }}>\n                              {query.message.length > 50 \n                                ? `${query.message.substring(0, 50)}...` \n                                : query.message\n                              }\n                            </div>\n                          </td>\n                          <td>\n                            <Badge bg=\"warning\">â³ Pending</Badge>\n                          </td>\n                          <td>\n                            <div className=\"d-flex gap-1\">\n                              <Button \n                                variant=\"outline-success\" \n                                size=\"sm\"\n                                onClick={() => toast.success('ğŸ“§ Response sent!')}\n                              >\n                                ğŸ“§\n                              </Button>\n                              <Button \n                                variant=\"outline-info\" \n                                size=\"sm\"\n                                onClick={() => toast.info('ğŸ‘ï¸ View details')}\n                              >\n                                ğŸ‘ï¸\n                              </Button>\n                            </div>\n                          </td>\n                        </tr>\n                      ))}\n                    </tbody>\n                  </Table>\n                </div>\n              </Tab>\n              \n              <Tab eventKey=\"reports\" title=\"ğŸ“Š Reports\">\n                <h5 className=\"mb-3\">System Reports</h5>\n                <Row>\n                  <Col md={6}>\n                    <Card className=\"mb-3\">\n                      <Card.Header>ğŸ“ˆ Sales Report</Card.Header>\n                      <Card.Body>\n                        <p>Generate comprehensive sales reports</p>\n                        <Button variant=\"primary\" size=\"sm\">\n                          ğŸ“Š Generate Report\n                        </Button>\n                      </Card.Body>\n                    </Card>\n                  </Col>\n                  <Col md={6}>\n                    <Card className=\"mb-3\">\n                      <Card.Header>ğŸ‘¥ User Activity</Card.Header>\n                      <Card.Body>\n                        <p>View user activity and engagement metrics</p>\n                        <Button variant=\"info\" size=\"sm\">\n                          ğŸ“‹ View Activity\n                        </Button>\n                      </Card.Body>\n                    </Card>\n                  </Col>\n                </Row>\n              </Tab>\n            </Tabs>\n          </Card.Body>\n        </Card>\n\n        {/* Add Category Modal */}\n        <Modal show={showAddCategory} onHide={() => setShowAddCategory(false)}>\n          <Modal.Header closeButton className=\"bg-primary text-white\">\n            <Modal.Title>â• Add New Category</Modal.Title>\n          </Modal.Header>\n          <Modal.Body>\n            <Form>\n              <Form.Group>\n                <Form.Label>ğŸ“ Category Name</Form.Label>\n                <Form.Control\n                  type=\"text\"\n                  value={newCategory}\n                  onChange={(e) => setNewCategory(e.target.value)}\n                  placeholder=\"Enter category name\"\n                />\n              </Form.Group>\n            </Form>\n          </Modal.Body>\n          <Modal.Footer>\n            <Button variant=\"secondary\" onClick={() => setShowAddCategory(false)}>\n              Cancel\n            </Button>\n            <Button variant=\"primary\" onClick={handleAddCategory}>\n              â• Add Category\n            </Button>\n          </Modal.Footer>\n        </Modal>\n\n        {/* Add User Modal */}\n        <Modal show={showAddUser} onHide={() => setShowAddUser(false)}>\n          <Modal.Header closeButton className=\"bg-primary text-white\">\n            <Modal.Title>â• Add New User</Modal.Title>\n          </Modal.Header>\n          <Modal.Body>\n            <Form>\n              <Form.Group className=\"mb-3\">\n                <Form.Label>ğŸ‘¤ Full Name</Form.Label>\n                <Form.Control\n                  type=\"text\"\n                  value={newUser.name}\n                  onChange={(e) => setNewUser({...newUser, name: e.target.value})}\n                  placeholder=\"Enter full name\"\n                />\n              </Form.Group>\n              <Form.Group className=\"mb-3\">\n                <Form.Label>ğŸ“§ Email</Form.Label>\n                <Form.Control\n                  type=\"email\"\n                  value={newUser.email}\n                  onChange={(e) => setNewUser({...newUser, email: e.target.value})}\n                  placeholder=\"Enter email address\"\n                />\n              </Form.Group>\n              <Form.Group className=\"mb-3\">\n                <Form.Label>ğŸ­ Role</Form.Label>\n                <Form.Select\n                  value={newUser.role}\n                  onChange={(e) => setNewUser({...newUser, role: e.target.value})}\n                >\n                  <option value=\"shopkeeper\">ğŸ›’ Shopkeeper</option>\n                  <option value=\"vendor\">ğŸª Vendor</option>\n                  <option value=\"admin\">ğŸ‘‘ Admin</option>\n                </Form.Select>\n              </Form.Group>\n            </Form>\n          </Modal.Body>\n          <Modal.Footer>\n            <Button variant=\"secondary\" onClick={() => setShowAddUser(false)}>\n              Cancel\n            </Button>\n            <Button variant=\"primary\" onClick={handleAddUser}>\n              â• Add User\n            </Button>\n          </Modal.Footer>\n        </Modal>\n      </Container>\n    </div>\n  );\n};\n\nexport default AdminPanel;