import React, { useState } from 'react';\nimport { Container, Row, Col, Card, Button, Badge, InputGroup, Form } from 'react-bootstrap';\nimport { categories } from '../../data/demoData';\nimport { useAuth } from '../../context/AuthContext';\nimport { toast } from 'react-toastify';\nimport LoginModal from '../auth/LoginModal';\n\nconst Home = () => {\n  const [selectedCategory, setSelectedCategory] = useState(null);\n  const [selectedSubcategory, setSelectedSubcategory] = useState(null);\n  const [showLogin, setShowLogin] = useState(false);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [sortBy, setSortBy] = useState('name');\n  const { user, addToCart } = useAuth();\n\n  const handleAddToCart = (product) => {\n    if (!user) {\n      setShowLogin(true);\n      return;\n    }\n    if (user.role !== 'shopkeeper') {\n      toast.error('âŒ Only shopkeepers can add items to cart!');\n      return;\n    }\n    addToCart(product);\n    toast.success(`âœ… ${product.name} added to cart!`);\n  };\n\n  const filteredProducts = selectedSubcategory?.products.filter(product =>\n    product.name.toLowerCase().includes(searchTerm.toLowerCase())\n  ).sort((a, b) => {\n    if (sortBy === 'price') return a.price - b.price;\n    if (sortBy === 'name') return a.name.localeCompare(b.name);\n    return 0;\n  }) || [];\n\n  const renderCategories = () => (\n    <>\n      <div className=\"text-center mb-5\">\n        <h1 className=\"display-4 mb-3\">ğŸª Welcome to B2B Commerce</h1>\n        <p className=\"lead\">Discover amazing products from trusted vendors</p>\n      </div>\n      \n      <Row className=\"g-4\">\n        {categories.map(category => (\n          <Col xs={12} sm={6} md={4} lg={3} key={category.id}>\n            <Card className=\"h-100 shadow-sm category-card\">\n              <Card.Body className=\"d-flex flex-column text-center\">\n                <div className=\"mb-3\" style={{ fontSize: '3rem' }}>\n                  {category.name === 'Electronics' ? 'ğŸ“±' : 'ğŸ‘•'}\n                </div>\n                <Card.Title className=\"mb-3\">{category.name}</Card.Title>\n                <Badge bg=\"info\" className=\"mb-3\">\n                  {category.subcategories.length} subcategories\n                </Badge>\n                <div className=\"mt-auto\">\n                  <Button \n                    variant=\"primary\" \n                    className=\"w-100\"\n                    onClick={() => setSelectedCategory(category)}\n                  >\n                    ğŸ” Explore\n                  </Button>\n                </div>\n              </Card.Body>\n            </Card>\n          </Col>\n        ))}\n      </Row>\n    </>\n  );\n\n  const renderSubcategories = () => (\n    <>\n      <div className=\"d-flex align-items-center mb-4\">\n        <Button \n          variant=\"outline-secondary\" \n          onClick={() => setSelectedCategory(null)} \n          className=\"me-3\"\n        >\n          â† Back\n        </Button>\n        <h3 className=\"mb-0\">\n          {selectedCategory.name === 'Electronics' ? 'ğŸ“±' : 'ğŸ‘•'} {selectedCategory.name} - Subcategories\n        </h3>\n      </div>\n      \n      <Row className=\"g-4\">\n        {selectedCategory.subcategories.map(sub => (\n          <Col xs={12} sm={6} md={4} lg={3} key={sub.id}>\n            <Card className=\"h-100 shadow-sm subcategory-card\">\n              <Card.Body className=\"d-flex flex-column text-center\">\n                <div className=\"mb-3\" style={{ fontSize: '2.5rem' }}>\n                  {sub.name === 'Mobile' ? 'ğŸ“±' : \n                   sub.name === 'Laptop' ? 'ğŸ’»' : 'ğŸ‘”'}\n                </div>\n                <Card.Title className=\"mb-3\">{sub.name}</Card.Title>\n                <Badge bg=\"success\" className=\"mb-3\">\n                  {sub.products.length} products\n                </Badge>\n                <div className=\"mt-auto\">\n                  <Button \n                    variant=\"success\" \n                    className=\"w-100\"\n                    onClick={() => setSelectedSubcategory(sub)}\n                  >\n                    ğŸ›ï¸ View Products\n                  </Button>\n                </div>\n              </Card.Body>\n            </Card>\n          </Col>\n        ))}\n      </Row>\n    </>\n  );\n\n  const renderProducts = () => (\n    <>\n      <div className=\"d-flex align-items-center justify-content-between mb-4\">\n        <div className=\"d-flex align-items-center\">\n          <Button \n            variant=\"outline-secondary\" \n            onClick={() => setSelectedSubcategory(null)} \n            className=\"me-3\"\n          >\n            â† Back\n          </Button>\n          <h3 className=\"mb-0\">{selectedSubcategory.name} - Products</h3>\n        </div>\n        <Badge bg=\"primary\">{filteredProducts.length} products</Badge>\n      </div>\n      \n      {/* Search and Filter */}\n      <Row className=\"mb-4\">\n        <Col md={8}>\n          <InputGroup>\n            <InputGroup.Text>ğŸ”</InputGroup.Text>\n            <Form.Control\n              type=\"text\"\n              placeholder=\"Search products...\"\n              value={searchTerm}\n              onChange={(e) => setSearchTerm(e.target.value)}\n            />\n          </InputGroup>\n        </Col>\n        <Col md={4}>\n          <Form.Select value={sortBy} onChange={(e) => setSortBy(e.target.value)}>\n            <option value=\"name\">ğŸ“ Sort by Name</option>\n            <option value=\"price\">ğŸ’° Sort by Price</option>\n          </Form.Select>\n        </Col>\n      </Row>\n      \n      <Row className=\"g-4\">\n        {filteredProducts.map(product => (\n          <Col xs={12} sm={6} md={4} lg={3} key={product.id}>\n            <Card className=\"h-100 shadow-sm product-card\">\n              <Card.Body className=\"d-flex flex-column\">\n                <div className=\"text-center mb-3\" style={{ fontSize: '2rem' }}>\n                  {product.name.includes('iPhone') ? 'ğŸ“±' :\n                   product.name.includes('MacBook') ? 'ğŸ’»' :\n                   product.name.includes('Dell') ? 'ğŸ–¥ï¸' : 'ğŸ“¦'}\n                </div>\n                <Card.Title className=\"h6\">{product.name}</Card.Title>\n                <Card.Text className=\"text-muted small flex-grow-1\">\n                  {product.description}\n                </Card.Text>\n                <div className=\"mt-auto\">\n                  <div className=\"d-flex justify-content-between align-items-center mb-2\">\n                    <span className=\"h5 text-success mb-0\">\n                      â‚¹{product.price.toLocaleString()}\n                    </span>\n                    <Badge bg=\"secondary\">â­ 4.5</Badge>\n                  </div>\n                  <small className=\"text-muted d-block mb-2\">\n                    ğŸª {product.vendor}\n                  </small>\n                  <Button \n                    variant=\"success\" \n                    className=\"w-100\"\n                    onClick={() => handleAddToCart(product)}\n                  >\n                    ğŸ›’ Add to Cart\n                  </Button>\n                </div>\n              </Card.Body>\n            </Card>\n          </Col>\n        ))}\n      </Row>\n      \n      {filteredProducts.length === 0 && (\n        <div className=\"text-center py-5\">\n          <div style={{ fontSize: '4rem' }}>ğŸ”</div>\n          <h5 className=\"text-muted mt-3\">No products found</h5>\n          <p>Try adjusting your search terms</p>\n        </div>\n      )}\n    </>\n  );\n\n  return (\n    <div style={{ minHeight: '100vh', backgroundColor: '#f8f9fa' }}>\n      <Container fluid className=\"py-4\">\n        <style>\n          {`\n            .category-card:hover, .subcategory-card:hover, .product-card:hover {\n              transform: translateY(-5px);\n              transition: transform 0.2s ease-in-out;\n            }\n          `}\n        </style>\n        \n        {!selectedCategory && renderCategories()}\n        {selectedCategory && !selectedSubcategory && renderSubcategories()}\n        {selectedSubcategory && renderProducts()}\n        \n        <LoginModal show={showLogin} onHide={() => setShowLogin(false)} />\n      </Container>\n    </div>\n  );\n};\n\nexport default Home;